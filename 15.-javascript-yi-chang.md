# 15. JavaScript异常

**1 JavaScript** **错误** **- Throw** **和** **Try to Catch**

错误总会发生！当执行 JavaScript 代码时，会发生各种错误。 错误可能是程序员的编码错误，由错误输入引起的错误，或者由于其他不可预见的问题。 try 语句使您能够测试代码块中的错误。  catch 语句允许您处理错误。  throw 语句允许您创建自定义错误。  finally 使您能够执行代码，在 try 和 catch 之后，无论结果如何。

**2 JavaScript try** **和** **catch**

try 语句允许您定义一个代码块，以便在执行时检测错误。  catch 语句允许你定义一个要执行的代码块，如果 try 代码块中发生错误。  JavaScript 语句 try 和 catch 成对出现。

当发生错误时，JavaScript 通常会停止并产生错误消息。  技术术语是这样描述的：JavaScript 将抛出异常（抛出错误）。 JavaScript 实际上会创建带有两个属性的 Error 对象：name 和 message。

**3 throw** **语句**

throw 语句允许您创建自定义错误。  从技术上讲您能够抛出异常（抛出错误）。 异常可以是 JavaScript 字符串、数字、布尔或对象。  如果把 throw 与 try 和 catch 一同使用，就可以控制程序流并生成自定义错误消息。  现代浏览器通常会结合 JavaScript 与内置的 HTML 验证，通过使用在 HTML 属性中定义的预定义的验证规则。

**4 finally** **语句**

finally 语句允许您在 try 和 catch 之后执行代码，无论结果：

**5 Error** **对象**

JavaScript 拥有当错误发生时提供错误信息的内置 error 对象。 error 对象提供两个有用的属性：name 和 message。

**6非标准的** **Error** **对象属性**

请勿在公共网站使用这些属性。它们并不会在所有浏览器中工作。            

**7. JavaScript错误**

**7.1** **意外使用赋值运算符**

如果程序员在 if 语句中意外使用赋值运算符（=）而不是比较运算符（===），JavaScript 程序可能会产生一些无法预料的结果。

**7.2** **期望松散的比较**

在常规比较中，数据类型不重要。这条 if 语句返回 true。  在严格比较中，数据类型确实重要。

有一个常见的错误是忘记在 switch 语句中使用严格比较。

**7.3** **令人困惑的加法和级联**

加法用于加数值。 级联（Concatenation）用于加字符串。 在 JavaScript 中，这两种运算均使用相同的 + 运算符。正因如此，将数字作为数值相加，与将数字作为字符串相加，将产生不同的结果。

**7.4** **令人误解的浮点**

JavaScript 中的数字均保存为 64 位的浮点数（Floats）。 所有编程语言，包括 JavaScript，都存在处理浮点值的困难：

**7.5** **对** **JavaScript** **字符串换行**

JavaScript 允许您把一条语句换行为两行。  但是，在字符串中间来换行是不对的，如果必须在字符串中换行，则必须使用反斜杠。

**7.6** **错位的分号**

因为一个错误的分号，此代码块无论 x 的值如何都会执行。

**7.7** **对** **return** **语句进行换行**

在一行的结尾自动关闭语句是默认的 JavaScript 行为。  JavaScript 也允许您将一条语句换行为两行。  如果把 return 语句换行为两行会发生什么呢：此函数将返回 undefined！  在 JavaScript 中，用分号来关闭（结束）语句是可选的。  JavaScript 会在行末关闭 return 语句，因为它本身就是一条完整的语句。  所以，绝不要对 return 语句进行换行。

**7.8通过命名索引来访问数组**

很多编程语言支持带有命名索引的数组。 带有命名索引的数组被称为关联数组（或散列）。

JavaScript 不支持带有命名索引的数组。在 JavaScript 中，数组使用数字索引，如果您使用命名索引，那么在访问数组时，JavaScript 会将数组重新定义为标准对象。 在自动重定义之后，数组方法或属性将产生未定义或非正确的结果。

**7.9** **用逗号来结束定义**

对象和数组定义中的尾随逗号在 ECMAScript 5 中是合法的。

**7.10 JSON** **不允许尾随逗号。**

**7.11 Undefined** **不是** **Null**

JavaScript 对象、变量、属性和方法可以是未定义的。  此外，空的 JavaScript 对象的值可以为 null。  这可能会使测试对象是否为空变得有点困难。  您可以通过测试类型是否为 undefined，来测试对象是否存在。

**7.12期望块级范围**

JavaScript 不会为每个代码块创建新的作用域。 很多编程语言都是如此，但是 JavaScript 并非如此。 认为这段代码会返回 undefined，是新的 JavaScript 开发者的常见错误：

